{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","components/Button/Button.js","components/Broker/BrokerBind.js","desktop/pages/Broker/BrokerBind.js"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","Button","btnText","className","disabled","click","afterClick","checkApprove","wallet","spec","lang","useState","status","setStatus","isApproved","setIsApproved","pending","setPending","buttonText","setbuttonText","loadRef","useRef","onClick","a","beforeAction","afterAction","current","style","display","loadApproveStatus","detail","account","pool","bTokenId","res","approve","success","alert","useEffect","ref","marginRight","inject","observer","address","setAddress","isBind","setIsBind","BindBroker","bindAddress","toLocaleLowerCase","length","indexOf","setBroker","chainId","console","log","getBroker","path","fetchRestApi","data","broker_address","type","placeholder","onChange","event","target","addressChange","Bind"],"mappings":"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","file":"static/js/23.a3e13722.chunk.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import {useState,useRef,useEffect} from 'react';\nexport default function Button({btnText,className,disabled,click,afterClick,checkApprove,wallet,spec,lang}){\n  const [status, setStatus] = useState(disabled ? 'disabled' : 'enabled');\n  const [isApproved, setIsApproved] = useState(true);\n  const [pending, setPending] = useState(false);\n  const [buttonText, setbuttonText] = useState(btnText)\n  const loadRef = useRef(null)\n\n  const onClick = async () => {\n    if(status !== 'enabled') {\n      return ;\n    }\n    beforeAction()\n    const result = await click();    \n    if(result){\n      afterClick && afterClick()\n    } \n    afterAction()\n  }\n\n  const beforeAction = ()  => {\n    setStatus('disabled')\n    setPending(true);\n    loadRef.current && (loadRef.current.style.display = 'inline-block')\n  }\n\n  const afterAction = () => {\n    loadRef.current && (loadRef.current.style.display = 'none')\n    setStatus('enabled')\n    setPending(false);\n  }\n\n  const loadApproveStatus = async () => {\n    if(checkApprove && wallet && wallet.detail.account){\n      const res = await wallet.isApproved(spec.pool,spec.bTokenId)\n      setIsApproved(res);\n    }\n  }\n  const approve = async () => {\n    beforeAction();\n    const res = await wallet.approve(spec.pool,spec.bTokenId);\n    if(res.success){\n      setIsApproved(true);\n    } else {\n      setIsApproved(false)\n      alert(lang['approve-failed'])\n    }\n    afterAction();\n  }\n\n  const action = () => {\n    if(isApproved){\n      onClick();\n    } else {\n      approve();\n    }\n  }\n\n  useEffect(() => {\n    loadApproveStatus();\n    return () => {};\n  }, [wallet,spec,checkApprove]);\n\n  useEffect(() => {\n    if(btnText){\n      setbuttonText(btnText)\n    }\n    return () => {\n    }\n  }, [btnText])\n\n  return(\n    <button className={className} onClick={action} >\n        <span className='btn-loading-wrap'>\n          <span ref={loadRef}\n            className='spinner spinner-border spinner-border-sm'\n            style={{display : 'none' ,marginRight : '2'}}>\n          </span>\n        </span>\n          {pending ? lang['pending'] : (isApproved ? buttonText : lang['approve'])  }\n        </button>\n  )\n}","import React,{useState,useEffect} from 'react'\nimport {inject,observer} from 'mobx-react'\nimport Button from '../Button/Button';\nimport {\n  fetchRestApi,\n  setBroker,\n} from \"../../lib/web3js/indexV2\";\nfunction BrokerBind({wallet={},lang}){\n  const [address,setAddress] = useState()\n  const [isBind,setIsBind] = useState(true)\n  \n  const hasConnectWallet = () => wallet && wallet.detail && wallet.detail.account\n\n  const BindBroker = async ()=>{\n    if( hasConnectWallet()){\n      if(address === undefined){\n        alert(lang['please-enter-address']) \n        return;\n      }\n      let bindAddress = address.toLocaleLowerCase();\n      if(bindAddress.length != 42 || bindAddress.indexOf('0x') != 0){\n        alert(lang['please-enter-a-correct-address']) \n        return;\n      }\n      if(bindAddress === wallet.detail.account){\n        alert(lang['brokder-addr-cannot-be-the-same-as-trader']) \n        return;\n      }\n      if(isBind){\n        alert(lang['cannot-bind-twice']) \n        return;\n      }\n      let res = await setBroker(wallet.detail.chainId,wallet.detail.account,address)\n      console.log(res)\n      if(!res.success){\n        alert(lang['bind-faild'])\n      }\n      if(res.success){\n        setIsBind(true)\n      }\n    }\n  }\n\n  const getBroker = async() =>{\n    let path = `/broker/${wallet.detail.account}/get_broker`\n    let res =  await fetchRestApi(path)\n    if(res.data){\n      if(res.data.length){\n        setIsBind(true)\n        setAddress(res.data[0].broker_address)\n      }else{\n        setIsBind(false)\n      }\n    }else{\n      setIsBind(false)\n    }\n  }\n\n  const addressChange = event =>{\n    let {value} = event.target\n    setAddress(value)\n  }\n  useEffect(()=>{\n    getBroker();\n  },[wallet.detail])\n  return(\n    <div className='broker-bind'>\n      <div className='header'>\n        {lang['brokers-address']}\n      </div>\n      <div className='bind-input'>\n        <div className='address'>\n          <input className='address-input' type='text'\n          placeholder={lang['address']}\n          value={address}   \n          onChange={event =>  addressChange(event) }\n          />\n        </div>\n        <div className='bind-button'>\n          <Button className='btn' btnText={lang['bind']} lang={lang} click={BindBroker} />\n        </div>\n      </div>\n    </div>\n  )\n}\nexport default inject('wallet')(observer(BrokerBind))","import BrokerBind from '../../../components/Broker/BrokerBind'\nimport \"./Bind.less\"\nexport default function Bind({lang}){\n  return (\n    <BrokerBind lang={lang}/>\n  )\n}"],"sourceRoot":""}